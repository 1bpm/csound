/*******************
 * CSOUND 5 - BETA *
 *******************/
 
[AUTOTOOLS]-----------------------------------------------------------------

To compile Csound 5, you'll need to install up to date versions of the 
GNU autotools: aclocal, autoconf, autoheader, autogen, automake, and libtool.

[ABOUT THE SOURCES]---------------------------------------------------------

The sources are broken down into the following subdirectories: 

anal	- analysis/resynthesis tools
Engine	- code for the main Csound engine
H	- all header files
InOut	- code for graphics, soundfile, and realtime audio input/output
OOps	- code for Csound opcodes
Opcodes	- code for Csound opcodes
strings	- localized string messages and utility program
Top	- code that will generate binaries
util1	- score related utilities
util2	- audio file related utilities

[DEPENDENCIES]--------------------------------------------------------------

Csound 5 tries to use the sndfile library to read and write soundfiles,
the portaudio library to read and write real-time audio,
the SDIF library to read and write SDIF files,
and the fltk library to graph function tables and draw control widgets.

CsoundVST needs Python 2.3, SWIG, and boost 
(put the boost source directories into /usr/local, i.e. /usr/local/boost). 

[Windows dependencies]

Csound5 on Windows is built with Cygwin, 
so all dependencies also need to be built with Cygwin or to have Cygwin import libraries.

Portaudio needs the Windows multimedia library (libwinmm.a). You can run ./configure --with-winapi=wmme --with-host_os=mingw.

SDIF's configure.in needs to have AC_LIBTOOL_WIN32_DLL added just above 
AC_PROG_LIBTOOL, and the configure.in and Makefile.am files in the topmost directory need 
to be converted to Unix text.

[Linux dependencies]

Portaudio needs the ALSA library (libasound.so). If the portaudio library doesn't build,
copy the config.sub and config.guess files from Csound 5 to the portaudio directory and 
run ./configure.

[COMPILING CSOUND]----------------------------------------------------------

To compile, enter the root of the source tree (the same directory as this README file), 
and type:

	autoreconf -i -f

This will recreate the configuration script files.  After this is done, type:

	./configure

and the file will check your system to see if required libraries are 
available.  Optionally, if you type:

	./configure --help

a list of additional commandline flags will be shown that you may use to 
customize the configure script.

After this completes, a Makefile will be generated. Now type:

	make

and this will start the build process.  

[HOW TO MAKE A NEW PLUGIN OPCODE]-------------------------------------------

The following assumes you already know how to make a regular Csound opcode.
Supposing that your opcode is named xxx, perform the following steps:

(1)	Write your xxx.c and xxx.h file as you would for a regular 
	Csound opcode. Put the files in the csound5/Opcodes directory.

(2)	#include "csdl.h" in your opcode sources. This causes the
	plugin development environment to simulate the regular Csound opcode
	development environment.

(3)	Add your OENTRY records and opcode registration functions 
	at the bottom of your C file. Example 
	(but you can have as many opcodes in one plugin as you like):
		
	#define S       sizeof

	static OENTRY localops[] = {
	{ "xxx", S(XXX), 5, "a", "ao", (SUBR)xxxset, NULL, (SUBR)xxx}
	};

	/*
	 * The following macro from csdl.h defines 
	 * the "opcode_size()" and "opcode_init()" 
	 * opcode registration functions for the localops table.
	 */
	LINKAGE
		
(4)	Add your plugin as a new target in plugin opcodes section 
	of the Csound 5 Makefile.am:

	pkglib_LTLIBRARIES+=xxx.la
		
(5)	Add rules to build your plugin in the Csound 5 Makefile.am
	(the autotools will fill in the correct compiler and linker
	flags for your system):

	xxx_la_SOURCES=Opcodes/xxx.c
	xxx_la_CPPFLAGS=@PLUGIN_CPPFLAGS@
	xxx_la_CFLAGS=@PLUGIN_CFLAGS@
	xxx_la_LDFLAGS=@PLUGIN_LDFLAGS@ 
	xxx_la_LIBADD=@PLUGIN_LIBADD@
		
(6)	Regenerate the Makefile in the csound5 directory, and rebuild:

	autoreconf -i -f
	./configure
	make

