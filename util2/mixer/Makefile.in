#								mixer Makef
# macros passed from csound/Makefile
#	CFLAGS INCLUDE LIB DEST

INCLUDE	= @includedir@
LIB	= @datadir@
DEST	= @bindir@
CFLAGS  = @CFLAGS@ @XCFLAGS@ $(DEFINES)
LIBS    = @WINLDFLAGS@ @X_LIBS@ @LIBS@

OBJS =	$T/sndinfo.@OBJEXT@ $T/filopen.@OBJEXT@ $T/sfheader.@OBJEXT@ \
	$T/libsnd.@OBJEXT@ $T/rtpa.@OBJEXT@ $T/libsnd_u.@OBJEXT@ \
	$T/memalloc.@OBJEXT@ $T/getstring.@OBJEXT@ $T/natben.@OBJEXT@

T = ../..

INC = ../../H

all:	extractor mixers

mixers:		mixer


mixer:		mixer.@OBJEXT@ $(OBJS)
		@CC@ $(CFLAGS) mixer.@OBJEXT@ $(OBJS) -lportaudio -lsndfile -lm -o mixer

extractor:	xtrct.@OBJEXT@ $(OBJS)
		@CC@ $(CFLAGS) xtrct.@OBJEXT@ $(OBJS) -lportaudio -lsndfile -lm -o extractor

mixer.@OBJEXT@:	mixer.c $(INC)/ustub.h $(INC)/cs.h $(INC)/soundio.h
		@CC@ -c $(CFLAGS) -I$(INC) mixer.c

xtrct.@OBJEXT@:	xtrct.c $(INC)/ustub.h $(INC)/cs.h $(INC)/soundio.h
		@CC@ -c $(CFLAGS) -I$(INC) xtrct.c

install:	mixer extractor
		-strip mixer
		rm -f $(DEST)/mixer
		cp mixer $(DEST)
		-strip extractor
		rm -f $(DEST)/extractor
		cp extractor $(DEST)

clean:		rmbak
		-rm mixer
		-rm extractor
		-rm *.@OBJEXT@

rmbak:
		-rm *.bak *~
